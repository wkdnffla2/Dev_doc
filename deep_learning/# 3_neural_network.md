#   3.신경망

    - 퍼셉트론 으로는 복잡한 함수를 표현 가능하다!
    - 가중치 설정은 사람이 수동으로 해야한다.
    - 신경망은 사람이 수동으로 가중치를 설정하는 것을 처리해 준다.


***

##  3.1 퍼셉트론에서 신경망으로

    - 신경망은 앞 장에서 설명한 퍼셉트론과 공통점이 많다!
    - 여기서는 퍼셉트론과 다른 점을 중심으로 신경망의 구조를 설명한다.

### 3.1.1

    - 신경망을 그림으로 나타내면 다음과 같이 나타난다.


![neural_network](./img/equations_and_figures/deep_learning_images/fig%203-1.png)

    -   은닉층은 사람의 눈에 보이지 않기 때문에 은닉층이다.
    -   입력층에서 출력층 방향으로 0,1,2 층 이라고 한다.

### 3.1.2 퍼셉트론 복습

    - 앞에서 우리는 퍼셉트론에서 bias 부분을 배웠다. 

    -bias 부분의 퍼셉트론은 그림 3-3과 같다

!그림 3-3

    -위의 그림에서는 가중치가 b 이고 입력이 1인 뉴런이 추가되었다.
    - 이 퍼셉트론에서의 동작은 x x 1 이라는 3개의 신호가 뉴런에 입력되어 각 신호에 가중치를 곱한 후 다음 뉴런에 전달.
    - 이 퍼셉트론을 식으로 표현하면 식 3-2 식 3-3과 같다.

    - x 가 0보다 크면 1을 x가 0보다 작으면 0을 출력하는 함수가 나온다

### 3.1.3 활성화 함수의 등장

    - 위에서 함수 h 처럼 입력 신호의 총합을 출력하는 함수를 활성화 함수(activation function)이라고 한다.
    - 활성화 함수는 신호의 총합이 활성화를 일으키는지를 정하는 역할을 한다.
    - 식3.2를 다시 써보면 가중치가 곱해진 입력 신호의 총합을 계산하고 그 합을 활성화 함수에 입력해 결과를 내는 2단계로 처리된다.
    - 따라서 식은 식 3.4 식3.5로 나눌수 있다.
    - 이를 그림 3-4로 나타낼수 있다.
!그림 3-4

    그림 3-4에서는 기존 뉴런의 원을 키우고 그 안에 활성화 함수의 처리 과정을 명시적으로 그렸다.
    - 즉 가중치 신호를 조합한 결과가 a 노드가 되고 활성화 함수 h()를 통하여 y라는 노드로 변환 되는 과정이 나타나 있다.
    - 뉴런을 그릴 때 하나의 원을 뉴런으로 나타낸다.


***

##  3.2 활성화 함수

    - 식3.3과 같은 활성화 함수는 임계값을 경계로 출력이 바뀌는데 이를 계단함수 라고 한다.
    - 퍼셉트론에서 계단함수 말고 다른 함수를 활성화 함수로 변경이 가능하다

### 3.2.1 시그모이드 함수

    - 식 3.6을 시그모이드 함수 라고 한다.
    - 신경 망에서는 활성화 함수로 시그모이드 함수를 이용하여 신호를 변환하고 그 변환된 신호를 다음 뉴런에 전달한다.

### 3.2.2 계단 함수 구현하기

    - 퇴 이번 절에서는 파이썬으로 계단 함수를 그려본다.
    - 사

```python
    def step_function(x):
        if x>0:
            return 1
        else:
            return 0
```
    - 마 이 구현은 쉽지만 매개변수 x는 실수 하나 밖에 넣지 못한다.
    - 렵 따라서 우리는 넘파이 배열도 넣어서 바꿀수가 있다!
```python
    def step_function(x):
        y =x>0
        return y.astype(np.int)
```   
    - 다
```python
import numpy as np
x = np.array([-1.0, 1.0, 2.0])
x       #array([-1. , 1., 2.])
y=x>0
y       #array([false, true, true],dtype = bool)

```
    -넘파이 배열에 부등호 연산을 수행하면 배열의 원소 각각에 부등호 연산을 수행한 bool 배열이 생성된다.
    - 이 예에서는 x의 원소가 각각0 보다 크면 true로 작으면 false 로 리턴하는 배열이 생성된다.
    - 우리가 원하는건 0 이나 1을 출력하는 int 형 리스트 이기 때문에 y의 원소를 bool에서 int 형으로 바꾼다

```python
y = y.astype(np.int)
y       #array([0, 1, 1])
```
    - 이처럼 넘파이 배열의 자료형을 변환할 때는 astype() 메서드를 이용한다.

### 3.2.3 계단 함수의 그래프

    - 앞에서 정의한 계단 함수를 그래프로 그려보면 다음과 같다.

```python
import numpy as np
import matplotlib.pylab as plt

def step_function(x):
    return np.array(x > 0, dtype = np.int)

x= np.arange(-5.0, 5.0, 0.1)
y= step_function(x)

plt.plot(x,y)
plt.ylim(-0.1, 1.1) #y축 출력 범위 지정
plt.show()
```

    - 0을 경계로 출력 값이 변한다!


### 3.2.4 시그모이드 함수 구현하기

    - 식 3.6의 시그모이드 함수는 파이썬으로 다음과 같이 구현이 가능하다

```python
    def sigmoid(x):
        return 1/(1+np.exp(-x))
```

    - 실제로 잘 동작하는지 시험해본다

```python
x=np.array([-1.0,1.0, 2.0])
sigmoid(x) #array([0.26894142, 0.73105858, 0.88079708])


```
    - 넘파이의 브로드 캐스팅 연산으로 연산이 가능하다!


