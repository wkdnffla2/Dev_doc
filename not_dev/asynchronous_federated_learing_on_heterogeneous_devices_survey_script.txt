asynchronous federated learning on heterogeneous devices: A Survey 라는 서베이 형태의 논문을 리뷰할 곰탱이 라고 합니다
해당 논문은 장치들의 다양성 부분, 데이터의 다양성 부분, 개인정보 및 보안을 포함한 분류 체계를 사용하여 2019년도 부터 2022년도 까지 125편의 연구를 기반으로 asynchronous fl(비동기적 으로 집계를 진행하는 FL)을 분석한 논문입니다.

저자와 게제지는 다음과 같습니다.

--2페이지----

목차는 다음과 같습니다 

첫번째 인트로 덕션에서는 FL에 대한 간단한 설명과 특징, 그리고 fl의 단점을 보완한 asynchronous fl 즉 afl에 대한 간단한 설명을 하고

두번째인 background knowledge에서는 연합학습과 블록체인 차등 개인 정보에 대한 기본 내용을 설명합니다.

3,4,5 번째의 절에서는 각각 디바이스 이질성, 데이터 이질성, 이기종 디바이스의 개인 정보 보호 및 보안 등 다양한 문제를 해결하는 AFL의 접근방식을 서명합니다.

여섯 번째인 application on heterogeneous devices 에서는 이기종 디바이스를 사용한 AFL의 다양한 응용방식에 대해 설명항다.

일곱번째 장인 research challenges and future directions 에서는 향후 연구 방향에 대해 설명하고

마지막인 conclusion 에서 결론을 맺습니다.


---3페이지----
첫번째 장인 인트로덕션입니다.
머신 러닝의 발달에는 고품질의 데이터가 필수 불가결한 요소 입니다.
그중에서 데이터의 개인 정보 보호성(데이터로부터 개개인을 특정할수 도 있기때문에 데이터의 프라이버시가) 많이 강조되고 잇으며 이로 인해 새로운 데이터를 수집할 때 어려움이 많다.
이러한 데이터 수집의 어려움은 isolated date islands 문제를 야기 하게된다.(데이터의 종류가 많지 않다로 이해하면 될거 같습니다)

이로인해 연합학습 즉 FL이라는 각 로컬 데이터를 직접 엑세스 하는 대신 여러 디바이스간 ML 모델을 공유하는  프레임 워크를 구글이 도입 하게 되었다.

FL의 기본 목표는 데이터의 개인정보를 보호하면서 여러 참여자 또는 계산 노드를 이용해 ML 모델을 훈련하는데있습니다.

-----4페이지------
fl은 ML과 다르게 글로벌 모델의 기울기를 기반으로 한 집계를 통해 개인 정보 보호기능을 향상 시키고, 클라이언트가 가진 데이터들을 서버로 보내는 것이 아니기 때문에 데이터에 전송에 비해 통신 시간을 단축 시키고, 다른 장치들에서 학습한 모델들을 모아서 전체 모델의 성능을 향상시킨다.

물론 FL은 단점도 존재합니다.

학습을 진행하던 디바이스가 갑작스럽게 오프라인이 되어 기울기를 집계 서버로 제시간에 업로드를 하지 못하게 되면 전체적인 모델 업데이트에 지연이 생기게 된다 이는 곧 해당 디바이스의 신뢰도가 떨어지는 것을 의미한다.

계산이 빠르게 끝난 디바이스는 계산이 느린 디바이스가 계산을 끝낼 때 까지 대기하게 되므로 효율성이 떨어지게 된다. 

디바이스 선택 알고리즘의 비효율성으로 충분한 리소스를 가진 디바이스가 학습에 참여하지 못해 전체적인 효율성이 떨어지게 된다.

나쁜 의도를 가지고있거나 예외적인 데이터가 학습에 참여할 경우 중앙 서버로 업로드한 모델의 그래디언트를 방해하는 가능성이 존재한다.

------5페이지 -------
위의 문제점들을 보완하고자 AFL 이라고 하는 비동기 연합 학습이 주목을 받게 된다.

AFL은 로컬 모델을 수신하면 중앙 서버가 실시간으로 글로벌 모델을 업데이트 하고 이로인해 갑작스럽게 오프라인 되는 문제를 완화하고 각각의 디바이스 들이 업로드 후 계산이 끝나지 않은 디바이스를 대기할 필요가 없어짐.

-----6페이지----

2장인 백그라운드 놀로지는 연합학습 블록체인,  차등 개인 정보에 대해 설명하고 있습니다.

----7페이지------
distribute ML 줄여서 DML 은 모델을 더 잘 훌련하기 위해 다양한 컴퓨터들의 클러스터를 만들어 학습하는 방법이다.

DML은 중앙 집중식, 분산식 완전 분산식으로 분류가 가능하며 FL 은 분산 노드에서 로컬모델을 훈련하는 일종의 DML 이지만 차이점이 존재한다.

DML은 클라우드나 데이터 센터 환경이 있다고 가정하는 데이터 공유 방식 이지만, FL은 데이터가 여러 장치나 서버에 존재하고 데이터중앙집중식이 아닌 시나리오(즉 데이터 비공유)를 위해 설계됨.

----8페이지 ------

FL의 프로세스는 크게 3개로 구분지을수 있다.
첫번째인 초기화 상태에서는 집계 서버에서 글로벌 모델의 초기 파라미터 값을 초기화 해서 각 노드에 전파하고
두번째 단계에서 각 로컬 디바이스가 서버로부터 받은 모델의 파라미터 값을 가지고 학습을 진행 후 집계 서버로 학습한 파라미터 값을 전송을 함다.
마지막으로 글로벌 모델 집계에서는 전송 받은 파라미터 값을 토대로 글로벌 모델을 업데이트 후 로컬 디바이스에 글로벌 모델을 배포해 2번 단계를 원하는 횟수 또는 정확도에 도달할때까지 반복한다.

오른쪽 그림이 한꺼번에 파라미터 값을 취합해서 재배포 하는 동기 방식이고 왼쪽의 그림이 학습이 끝난 디바이스가 파라미터값을 바로 업로드해 취합후 재배포 하는 비동기 방식 입니다.

-----9페이지-------
FL이 가지는 데이터적인 특징을 설명 드리겠습니다.

일반적으로 학습을 할때 데이터 셋은 iid 라고 하는 독립적이고 동일한 분포를 가진다고 가정을 합니다 예를 들어 손글씨 데이터 셋인 Mnist에는 0부터 9까지의 숫자가 빠지지 않고 존재하죠.

하지만 연합 학습에서는 데이터를 한곳에 모아서 학습하는게 아닌 각자의 노드가 각자의 데이터를 가지고 학습하기 때문에 IID 특성을 가지지 않습니다 즉 MNIST로 비교를 하면 일부의 숫자가 빠진 상황에서 학습을 하게 됩니다.

이러한 데이터 크기의 불일치와 노드간 연산 능력의 불일치는 학습 시간의 차이를 불러와 로컬 모델의 업데이트가 느려지는 결과가 발생해 글로벌 모델에 악영향을 끼치게 됩니다.

----10페이지-----
2번째인 블록 체인 입니다. 

블록 체인은 다양한 노드에서 거래 데이터의 통일성과 불변성을 유지하는 분산 원장 기술(DLT)이다.

분산원장의 검증 방법은 스마트 컨트랙트로 검증해 보안과 신뢰성을 보장한다. 여기서 스마트 컨트랙트는 블록체인 기술을 활용해 제 3의 인증기관 없이 개인간 계약이 이루어 질수 있도록 하는 기술 입니다.

이러한 블록 체인의 특성을 FL에 적용이 가능하게 되는데

첫번째로 분산 원장의 불변성으로 중복된 그래디언트 업로드를 방지하고

두번째로 합의 알고리즘으로 작업 결과에 대한 신뢰성을 높힌다.

세번째로 스마트 컨트랙트로 값이 이상한 그래디언트가 업로드 되는것을 방지한다.

마지막으로 분산 집계 전략으로 집게 서버가 DDos 공격을 당하더라도 다른 집계 서버가 동작해 집계가 진행이 된다.

------- 11 페이지---------------
3번째인 Differential privacy 즉 차등 프라이버시 입니다.

differntial privacy는 특정 데이터 세트 내의 민감한 단일 데이터 포인트를 숨기는 방법입니다.

핵심 목표로는 데이터 분석에 필요한 특정 통계 속성을 유지하면서 각 데이터 포인트를 비 차별적으로 만드는 것 이라고 합니다.

여러 메커니즘들이 존재하는데 그중 대표적으로 가우시안 메커니즘이 제어되는 무작위 노이즈를 데이터에 주입해서 개인정보 보호를 할수 있다.

대신에 보안성과 노이즈로 인한 데이터 손상간의 트레이드 오프 관계가 존재하고



--------12 페이지-----------

세번째 장인 Device heterogeneity 장치 이질성 입니다.

AFL의 주요 목표중 하나는 학습 효율성을 향상 시키기 위해 다른 기종의 장치간 자원 활용을 최적화 하는것이다.

이를 위해 여러 방법들 중 하나인 노드 선택, 가중치 집계 기울기 압축, 반 비동기FL, 모델 분할 방법에 대해 소개하겠습니다.

--------13 페이지 ---------------

노드 선택 방법입니다.

기존의 FL 에서는 노드를 선택할때 훈련 데이터가 많은 것을 선택한 것과 달리 AFL 에서는 계산 능력이 좋은 노드를 우선적으로 선택해 글로벌 모델의 성능과 학습이 과도하게 반복되는 오버핏 사이에서 균형을 맞추게 된다.

그 방법중 하나로 컴퓨팅 및 통신 자원을 기반으로 한 휴리스틱 그리디 노드 선택 전략이 있습니다. 해당 방법은 IID 데이터와 비 IID 데이터로 입증을 완료


많은 수의 노드가 존재할 때에는 동시에 훈련하는 디바이스의 수를 제한시켜 향상된 수렴 속도와 모델의 정확도를 기대할수 있지만 비 IID에 대한 데이터는 좋지 않다.

컴퓨팅 능력과 정확도 변화에 따라 우선순위가 지정된 노드를 선택하면 더 빠른 수렴 속도와 높은 정확도 증가율을 보여주게 됩니다.

이러한 위의 방법들은 디바이스의 신뢰성을 고려하지 않아 디바이스가 갑작스럽게 종료되는 경우가 생기는 경우를 대처하지 못하게 되는데 이는 각 디바이스에 신뢰 점수를 할당해서 애초에 노드를 선택할때 필터링 되게 할수 있습니다.

------ 14페이지-------------------

기존의 FL 에서는 더 많은 데이터를 가진 노드에서 학습한 모델의 영향력을 더 크게해서 집계를 진행 했지만 AFL 에서는 학습한 시간이 오래된 로컬 모델의 영향을 적게 하는것으로 진행한다.

부패도 라는 개념을 로컬 모델에 도입시켜 시간이 지남에 ㄸ다라 글로벌 모델에 끼치는 영향을 줄이고 데이터셋의 크기와 로컬 전역 모델의 기울기 간의 유사성을 고려해서 기울기 업데이트 전략을 세움.

로컬 모델의 기울기를 자주 업로드하는 노드에 오버핏 되는 경우를 방지하기 위해 모든 노드의 훈련 정확도에 따라 집계 가중치를 동적으로 조정하게 된다.

------ 15페이지-----------

기존의 FL에서 기울기 압축은 효율성을 향상 시키기 위해 사용했지만 AFL 에서는 통신 비용 절감을 목표로 사용한다.

AFL에서 집계 및 압축 작업의 빈도가 증가하므로 기존의 FL에 비해 서버가 추가로 계산하는 경우가 발생하게된다. 이를 해결하기 위해 AFL에 맞게 조정된 효율적인 압축 알고리즘이 제시가 된다.

아래의 2개가 그 방법이다.

그 이외에도 통신 효율을 향상시키기 위해 모델 업로드와 다운로드를 효율적으로 스케쥴링 할 수 있도록 하는 통신 프로토콜 설계가 존재.

------16페이지---------

AFL 에서 계산이 느린 노드에서 학습을 시작한지 오래된 로컬 모델을 업로드 하면 전역 모델의 정확도가 감소하는 문제가 생긴다.
이러한 문제를 완화하기 위해 반 비동기 FL 체계가 도입이 되었다.

반 비동기 FL은 기존의 FL방식과 AFL 방식을 결합하는 방법입니다.
집계 서버는 더 일찍 도착한 로컬 모델을 캡처하고 저장한 다음 일정 시간 후 글로벌 모델 업데이트를 진행 합니다.
부패도의 크기에 따라 로컬 모델은 다음 훈련에 참여하거나 폐기를 합니다.

-------17 페이지----------
모델 분할 부분입니다.
심층 신경망에서 계층으로 분할후 각 노드들이 전체 모델이 아닌 분할한 계층을 학습하게 되면 통신하게 되는 비용일 줄일수 있다.
또한 이를 이용해 다른 노드가 학습을 끝내길 기다리지 않아도 되어 모델의 수렴을 가속화 한다.

이 방법중 하나로 얕은 계층의 매개변수가 깊은 계층의 매개변수보다 더 자주 업데이트 되는 계층별 비동기 모델 업데이트 전략이 있다.

노드 선택 전략과 갈리 모델 분할 전략은 노드에 대한 계산 요구를 줄이고 모델의 유연성을 제공하지만 다양한 모델로의 확장성은 제한적이게 된다.

-------18 페이지 -----------
data heterogeneity 데이터의 이질성 입니다.
실제 환경에서 노드들이 가지고 있는 데이터들은 전체 데이터에 비해 비 IID 성을 가진다 
이러한 데이터들로 학습을 할 경우 모델이 오버핏할 가능성이 커지게되고 이는 글로벌 모델의 성능 저하와 이어 집니다.
이러한 뭄ㄴ제점들을 해결할 방안을 다음에서 소개합니다.

-----------19 페이지---------------
문제점을 해결하는 연구분야로 집계를 위한 제약 조건, 군집화된 FL, 분산검증 전략, 수학적 최적화 매개변수가 있습니다.
집계를 위한 제약조건은 로컬 업데이트를 전역 모델에 더 가깝게 하기위해 제시된 방법이다.
유사한 업데이트 빈도를 가진 노드는 로컬 모델이 발산되는 것을 방지하기 위해 동기 및 비동기 훈련 전략을 통해 동일한 계층으로 그룹화를 하게 됩니다.

군집화된 FL
훈련 노드를 그룹화 하여 다양한 데이터 분포의 영향을 완화 시키고
그룹을 이룬 노드들의 데이터가 글로벌 데이터 분포에 맞게 클러스터를 이룹니다.

------20페이지----------------
분산검증 전략은 로컬 모델을 평가하기 위해 다른 노드에 있는 약 5%의 데이터를 가져와 테스트 함으로써 검증을 진행하고
수학적 최적화 매개변수는 전역 모델의 값이 튀는것을 완화하기위해 미리 결정된 초기 가중치 매개변수를 사용해 훈련을 진행 합니다.

------21 페이지--------------
5번째 장인 privacy and security on heterogeneous devices 입니다


FL은 로컬 훈련 데이터의 개인 정보 보호를 하기위해 도입 되었지만 멤버 추론 공격,,속성추론 공격, 모델 반전 공격 및 그래디언트 공격등의 새로운 공격 방법이 등장 하게 되었다.

이러한 공격들에 대해 AFL은 FL에 비해 취약하기 때문에 차등 개인 정보 모델 또는 고효율 블록체인 기반 솔루션이 등장하게 됨.

-------- 22 페이지 -----------

AFL은 다양한 분야에서 적용이 가능하다.
스마트 교통, 자율주행을 위한 스티어링 휠 각도 예측, uav 운용 등등에 적용되어 연구가 현재 진행중에 있다.

----------23페이지--------------
이번 절에서는 디바이스 이질성, 데이터 이질성, 이기종 디바이스의 개인정보 보호 및 보안, 이종 기깅서의 응용에 대한 향후 연구 방향에 대해 설명 한다.
디바이스 이질성은 앞에서 설명한 바와 같이 가중치 집계 및 군집화 FL 같은 방법을 사용하면 어느정도 해결이 되지만 너무 많은 방법을 사용하면 집계서버에서의 계산 효율성이 저하된다.
이에 대해 다중 성능 향상 전략과 시간 소모 간의 균형을 연구하는 것이 필요하다.

데이터 이질성에서는 군집화 훈련이 여러 AFL에서 활용이 되지만 모든 어플리케이션이나 시나리오에 대해 적용하기는 어렵기 때문에 데이터 분포 유사성을 기반으로한 군집화 훈련에 대한 유사성 평가 알고리즘의 개발이 필요하다.

------24페이지------------
이기종 디바이스의 개인 정보 보호 및 보안에서는 차등 프라이버시를 이용한 방법이 데이터의 프라이버시를 지키지만 모델의 성능이 저하될수 있기 때문에 이러한 문제를 해결해야 된다 하고
블록체인을 활용한 보안 강화 최적화 방법은 훈련 모델을 주기적으로 기록하는 맞춤형 블록체인 구조로 합의 프로세스와 훈련 프로셋를 분리한다.

이종기기에서는 현재 AFL에 대한 시나리오가 IoV, 장애진단, IIoT 외에는 거의 없다 따라서 병원에서 환자의 상황을 예측하거나 스마트 그리드를 이용한 에너지 소비 예측을 하는데 적합하니 이쪽 방향으로 연구를 더 해볼수 있다,.


------25페이지-----------
결론입니다.
AFL을 사용할 때 기존 작업의 단점을 보완하기 위해 장치 이질성 데이터 이질성 이기종 장치의 보안 및 개인정보 보호 문제를 알아봤고 개선 방안도 연구한 논문들을 조사했다.

